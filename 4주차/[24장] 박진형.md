# 24장 클로저
클로저란?  

```
const x = 1;

function outer(){
  const x = 10;
  const inner = function() {console.log(x)};
  return inner;
}

const innerFunc = outer();
innerFunc();
```

> outer 함수는 inner를 반환하고 생명주기가 종료된다.   
> 따라서 innerFunc()을 실행하면 outer()의 x에 접근이 안될 것 같지만
x 가 부활한 것처럼 동작한다.

> 이처럼 외부 함수(outer)보다 중첩 함수(innerFunc)가 더 오래 유지되는 경우  
> 중첩 함수(innerFunc)는 이미 생명 주기가 종료한 외부 함수(outer)의 변수를 참조할 수 있다.  
> 이러한 중첩 함수(innerFunc)를 클로저라 한다. 

> 자바스크립트의 모든 함수는 자신의 상위 스코프를 기억한다.  
> 모든 함수가 기억하는 상위 스코프는 호출 위치에 상관없이 언제나 자신이 기억하는 상위 스코프의 식별자를 참조할 수 있으며
값을 변경할 수도 있다.

## 렉시컬 스코프
> 자바스크립트 엔진은 함수가 정의된 위치에 따라 상위 스코프를 결정한다.
> 이를 렉시컬 스코프(정적 스코프)라고 한다.


## 함수 객체 내부 슬롯 [[Environment]]
> 렉시컬 스코프가 가능하려면 함수는 상위 스코프를 기억해야한다.  
> 이때 함수가 정의된 위치가 상위 스코프이다.
> 
> 이를 위해 함수는 함수 정의가 평가되어 함수 객체를 생성할 때  
> 자신의 내부 슬롯 [[Environment]]에 상위 스코프의 참조를 저장한다.
> 
> 즉 자신이 존재하는 한 상위 스코프를 기억한다.

## 클로저의 활용
> 클로저는 상태를 안전하게 변경하고 유지하기 위해 사용한다.  
> 즉, 상태를 완전하게 은닉하고 특정 함수에게만 상태 변경을 허용하기 위해 사용한다.

```
let num = 0;

const increase = function() {
    return ++num;
};

console.log(increase());
```
위 코드는 정상동작 하지만 num 값을 좀 더 안전하게 관리하려면
num 값을 increase 함수만이 변경할 수 있도록 수정해야 합니다.

클로저를 활용하여 수정하면
```
const increase = (function () {
    let num = 0;

    //클로저
    return function() {
        return ++num;
    };
}());

console.log(increase());
```
위와 같이 num 변수를 increase 함수의 지역 변수로 변경하여 의도치 않은 변경을 막을 수 있습니다.


## 캡슐화와 정보 은닉
캡슐화는 객체의 상태를 나타내는 프로퍼티와 프로퍼티를 참조하고 조작할 수 있는 메서드를
하나로 묶은 것을 말한다.
캡슐화는 객체의 특정 프로퍼티나 메서드를 감출 목적으로 사용되기도 하는데
이를 정보 은닉이라한다.

정보 은닉은 외부에 공개할 필요가 없는 구현의 일부를 외부에 공개되지 않도록 감추어
적절치 못한 접근으로부터 객체의 상태가 변경되는 것을 방지해 정보를 보호하고
객체 간의 상호 의존성, 즉 결합도를 낮추는 효과가 있다.